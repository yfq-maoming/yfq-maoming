"use strict";(self["webpackChunkzhku"]=self["webpackChunkzhku"]||[]).push([[766],{4766:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"center"},[s("el-page-header",{attrs:{content:"个人信息"},on:{back:e.goBack}}),s("div",{staticClass:"header"},[s("div",{staticClass:"avatar header-item"},[s("img",{attrs:{src:e.user.avatar,alt:""}})]),s("div",{staticClass:"username header-item"},[e._v(" "+e._s(e.user.username)+" ")]),s("div",{staticClass:"money header-item"},[e._v("余额：￥"+e._s(e.user.money))])]),s("div",{staticClass:"index",staticStyle:{"padding-left":"30px"}},[s("form",[s("input",{attrs:{type:"file",name:"file"},on:{change:function(t){return e.getFile(t)}}}),s("button",{staticClass:"button button-primary button-pill button-small",on:{click:function(t){return e.submit(t)}}},[e._v(" 修改头像 ")])])]),s("div",{staticClass:"index"},[s("el-form",{attrs:{inline:!0,model:e.user,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"手机"}},[s("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.user.tel,callback:function(t){e.$set(e.user,"tel",t)},expression:"user.tel"}})],1),s("el-form-item",{attrs:{label:"性别"}},[s("el-input",{attrs:{placeholder:"请输入性别"},model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}})],1),s("el-form-item",{attrs:{label:"地址"}},[s("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.user.location,callback:function(t){e.$set(e.user,"location",t)},expression:"user.location"}})],1)],1),s("div",{staticClass:"option"},[s("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.update}},[e._v("确认修改")])],1)],1),s("div",{staticClass:"index"},[s("el-form",{attrs:{inline:!0,model:e.user,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"旧密码"}},[s("el-input",{attrs:{type:"password","show-password":"",placeholder:"请输入旧密码"},model:{value:e.updatePwd.oldPwd,callback:function(t){e.$set(e.updatePwd,"oldPwd",t)},expression:"updatePwd.oldPwd"}})],1),s("el-form-item",{attrs:{label:"新密码"}},[s("el-input",{attrs:{type:"password","show-password":"",placeholder:"请输入新密码"},model:{value:e.updatePwd.newPwd,callback:function(t){e.$set(e.updatePwd,"newPwd",t)},expression:"updatePwd.newPwd"}})],1),s("el-form-item",{attrs:{label:"确认密码"}},[s("el-input",{attrs:{type:"password","show-password":"",placeholder:"请再次输入密码"},model:{value:e.confirmPwd,callback:function(t){e.confirmPwd=t},expression:"confirmPwd"}})],1),s("div",{staticClass:"option"},[s("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.updatePwdBtn}},[e._v("修改密码")])],1)],1)],1)],1)},l=[],r={data:function(){return{user:{avatar:"",uid:null,username:"",sex:"",money:0,location:"",tel:""},updatePwd:{uid:null,oldPwd:"",newPwd:""},confirmPwd:""}},methods:{goBack:function(){this.$router.push("/allGoods")},getFile:function(e){this.file=e.target.files[0],console.log("getFile",this.file)},submit:function(e){var t=this;e.preventDefault();var s=new FormData;s.append("file",this.file),s.append("username",this.user.username),this.$axios.post("/user/upload",s).then((function(e){console.log("success",e.data.data),t.user.avatar=e.data.data,console.log("获取到了图片链接",t.user.avatar)})).catch((function(e){console.log("error",e)}))},update:function(){var e=this;console.log("获取到了user信息",this.user),this.$axios.post("/user/updateUserInfo",this.user).then((function(t){console.log("更新成功了吗？",t),e.$message({message:"修改成功",type:"success"})}))},updatePwdBtn:function(){var e=this;this.updatePwd.uid=this.user.uid,console.log(this.updatePwd),this.$axios.post("/user/updateUserPassword",this.updatePwd).then((function(t){console.log(t),201==t.data.state?e.$message.error("修改密码失败，原密码不正确"):(e.updatePwd.oldPwd="",e.updatePwd.newPwd="",e.confirmPwd="",e.$message({message:"修改成功",type:"success"}))}))}},created:function(){var e=this,t=localStorage.getItem("userId");this.$axios.get("/user/getUserInfo",{params:{uid:t}}).then((function(t){e.user.avatar=t.data.user.avatar,e.user.uid=t.data.user.uid,e.user.username=t.data.user.username,e.user.sex=t.data.user.sex,e.user.location=t.data.user.location,e.user.tel=t.data.user.tel,e.user.money=t.data.user.money}))}},o=r,i=s(1001),n=(0,i.Z)(o,a,l,!1,null,"5c774adc",null),u=n.exports}}]);